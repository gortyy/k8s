# Kubernetes DNS


K8s schedules DNS Pod and Service on cluster. Individual containers use DNS Service's IP to resolve DNS names. Every service in cluster has assigned DNS name. Pod's DNS search will include services under Pod's namespace and default cluster domain.

## Services

### A record

Services with a cluster IP have assigned DNS A record with name of the form `<service-name>.<namespace>.svc.cluster.local`. This DNS resolves to the service's cluster IP.
Headless services (those without cluster IP) also have assigned DNS A record with the form as above. However this DNS resolves to set of IPs of the pods selected by the service.

### SRV records

These records are created for named ports, which are part of headless services. SRV record for some named port would look like this: `<port-name>.<port-protocol>.<service-name>.<namespace>.svc.cluster.local`. For service with cluster IP this resolves to port number and domain name (`<service-name>.<namespace>.svc.cluster.local`). In case of headless service, this resolves to multiple answers, one for each pod that is running for given service. It contains port number and domain name of the pod, which has following form: `<auto-generated-name>.<service-name>.<namespace>.svc.cluster.local`.

## Pods

### A record

When A record is enabled, then pod has assigned DNS name of the form `<pod-ip>.<namespace>.pod.cluster.local`.

### Hostname and subdomain fields

When pod is created its hostname is the value of `metadata.name`. Optionally you can set `spec.hostname` field which takes precedence over Pod's `metadata.name`. Pod also has `spec.subdomain` field which can be set to specify subdomain.


## Running Examples

### kubectl

```shell
bash kubectl/main.sh
```

### python

```shell
python python/main.py --type code
# or
python python/main.py --type yaml
```

### go

```shell
cd go
go build -o ./main.out
./main.out
# or
./main.out -kubeconfig=$PATH_TO_K8S_CONFIG
```
